#!/usr/bin/env bash
# pre-commit – Lokale Pre-Commit Validierung
# Aktivierung: git config core.hooksPath .githooks
# Referenz: copilot-instructions.md Abschnitt 4

set -euo pipefail

echo "[pre-commit] Führe lokale Validierungen aus..."

if [ ! -f Makefile ]; then
    echo "[pre-commit] ERROR: Makefile nicht gefunden – kann Checks nicht ausführen" >&2
    exit 1
fi

# Governance-Checks
echo "[pre-commit] Führe 'make check-hooks' aus..."
make check-hooks || exit 1

# Secret-Scanning
echo "[pre-commit] Führe 'make secrets-check' aus..."
make secrets-check || exit 1

# Commit Message Check (wird von Git Hook commit-msg erledigt – hier nur Info)
echo "[pre-commit] Hinweis: Commit Message wird nach diesem Hook geprüft (commit-msg Hook)"

echo "[pre-commit] ✅ Pre-Commit Checks erfolgreich"
exit 0
